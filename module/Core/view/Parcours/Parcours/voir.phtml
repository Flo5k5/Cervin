<?php
$title = $Parcours->titre;
$this->headTitle($title);

$this->headLink()->prependStylesheet($this->basePath() . '/css/bootstrap-editable.css');
?>

<div class="page-header">
    <?php if ($this->isAllowed('Parcours') === true) :?>
    <h1>
    <i class="icon-road"></i> 
    <span class="edit CursorPointer"
                        data-url="<?php echo $this->url("parcours/modifier", array("id" => $Parcours->id)); ?>"
                        data-name="titre" 
                        data-type="text" 
                        data-inputclass="span10" 
                        data-pk="1"><?php echo $this->escapeHtml($title); ?></span>
    <small> <a href="#helpModal" data-toggle="modal"><i class="icon-info-sign"> </i></a></small> 
    </h1>
    <p class="edit CursorPointer"
                        data-url="<?php echo $this->url("parcours/modifier", array("id" => $Parcours->id)); ?>"
                        data-inputclass="span10" 
                        data-name="description" 
                        data-type="textarea" 
                        data-pk="1"><?php echo $this->escapeHtml($Parcours->description);?></p>
    <?php else : ?>
        <h1>
        <i class="icon-road"></i><?php echo $this->escapeHtml($title); ?>
    	<small> <a href="#helpModal" data-toggle="modal"><i class="icon-info-sign"> </i></a></small> 
    	</h1>
    	<p><?php echo $this->escapeHtml($Parcours->description);?></p>
    <?php endif;?>
</div>

<style type="text/css">

	.elements {
		width: 208px;
		text-align: center;
		padding: 20px 10px 20px 10px;
	} 
	
	a [class^="icon-"],a [class*=" icon-"],a [class^="icon-"]:before,a [class*=" icon-"]:before
	{
		display: inline-block;
	}
	
	.sous_parcours {
		border-style: dashed;
		border-width: 3px;
		border-color: #5B7244;
		padding: 5px 5px 20px 5px;
	}

</style>

<script type="text/vnd.graphviz" id="cluster">

//<!--
digraph "<?php echo $Parcours->titre; ?>" { 
graph [bgcolor="#f3f3f3"]
<?php echo $dot ; ?>}
//-->

</script>

<?php
$this->headScript()->appendFile($this->basePath() . '/js/viz.js');
$this->headScript()->appendFile($this->basePath() . '/js/jquery.panzoom.js');
?>


<section class="buttons">
    <button class="zoom-out btn btn-primary"><i class="icon-minus-sign"></i></button>
    <button class="zoom-in btn btn-primary"><i class="icon-plus-sign"></i></button>
    <!-- <input type="range" class="zoom-range"> -->
    <button class="reset btn btn-primary"><i class="icon-fullscreen"></i></button>
    <button class="btn btn-primary"><i class="icon-refresh"></i></button>
</section>

<br>

<!-- Graphe -->
<div style="overflow: hidden; position: relative; border:3px solid black;"> 
	<div id="panzoom" style="text-align: center; height: 1000px">
	</div>
</div>


<script>
    // https://github.com/timmywil/jquery.panzoom
      $("#panzoom").panzoom({
        $zoomIn: $(".zoom-in"),
        $zoomOut: $(".zoom-out"),
        $zoomRange: $(".zoom-range"),
        $reset: $(".reset")
      });
      
      function inspect(s) {
        return "<pre>" + s.replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/\"/g, "&quot;") + "</pre>"
      }
      
      function src(id) {
        return document.getElementById(id).innerHTML;
      }
      
      function example(id, format) {
        var result;
        try {
          result = Viz(src(id), format);
          if (format === "svg")
            return result;
          else
            return inspect(result);
        } catch(e) {
          return inspect(e.toString());
        }
      }
      $('#panzoom').html(example("cluster", "svg"));
      //document.body.innerHTML += example("cluster", "svg");

 </script>

<?php
$this->headScript()->appendFile($this->basePath() . '/js/bootstrap-editable.js');
$this->headScript()->appendFile($this->basePath() . '/js/bootstrap-confirm.js');
?>

<?php $this->inlineScript()->captureStart(); ?>
$('.edit').editable({
	mode: 'inline',
	emptytext: 'Vide'
});
<?php $this->inlineScript()->captureEnd();?>
