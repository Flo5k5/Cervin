<?php
$title = 'Gestion des types d\'elements';
$this->headTitle($title);
?>

<?php  $this->headLink()->prependStylesheet($this->basePath() . '/css/bootstrap-editable.css'); ?>

<div class="page-header">
    <h1><?php echo $this->escapeHtml($title); ?> <!-- <small>Subtext for header</small> --></h1>
</div>

<div class="row">
    <div class="span6">
        <h2>Artefacts
        <a class="btn btn-primary" href="<?php echo $this->url('zfcuser/register') ?>"><i class="icon-white icon-plus"></i> Nouveau Type d'Artefacts</a></h2>
        <div class="accordion" id="TEartefact">
            <?php foreach ($TEartefacts as $TEartefact) : ?>
            <div class="accordion-group">
                
                <div class="accordion-heading">
                    <a class="accordion-toggle nomValue" pk="label<?php echo $TEartefact->id ;?>" data-toggle="collapse" data-parent="#TEartefact" href="#collapse<?php echo $TEartefact->id ;?>">
                        <?php echo $TEartefact->nom ;?>
                    </a>
                </div>
                <div id="collapse<?php echo $TEartefact->id ;?>" class="accordion-body collapse">
                    <div class="accordion-inner">
                        <h4>Liste des champs : <span class="edit CursorPointer" data-name="nom" data-type="text" data-pk="<?php echo $TEartefact->id ;?>" data-url="<?php echo $this->url("typeElement/editTypeElementAjax",array('id'=>$TEartefact->id)) ?>"><?php echo $TEartefact->nom ;?></span></h4>
                        <dl>
                            <dt class="muted">Titre [text]
                            </dt>
                            <dd></dd>
                            <dt class="muted">Description [textarea]
                            </dt>
                            <dd></dd>
                        <?php foreach ($TEartefact->__get('champs') as $champ) : ?>
                                <dt><span class="edit CursorPointer" data-name="label" data-type="text" data-pk="1" data-url="<?php echo $this->url("typeElement/editTypeElementAjax",array('id'=>$TEartefact->id,'idChamp'=>$champ->id)) ?>"><?php echo $champ->label;?></span> [<?php echo $champ->format;?>]

                                    </dt>
                                <dd><p class="edit CursorPointer" data-name="description" data-inputclass="" data-type="textarea" data-rows="2" data-pk="1" data-url="<?php echo $this->url("typeElement/editTypeElementAjax",array('id'=>$TEartefact->id,'idChamp'=>$champ->id)) ?>"><?php echo $champ->description;?></p></dd>
                                
                        <?php endforeach ;?>
                        </dl>
                        <a class="btn btn-primary" href="<?php echo $this->url('zfcuser/register') ?>"><i class="icon-white icon-plus"></i> Nouveau Champ</a>
                    </div>
                </div>
            </div>
            <?php endforeach ;?>
        </div>

    </div>
    <div class="span6">
        <h2>Medias <a class="btn btn-primary " href="<?php echo $this->url('zfcuser/register') ?>"><i class="icon-white icon-plus"></i> Nouveau Type de Medias</a></h2>
        <div class="accordion" id="TEmedia">
            <?php foreach ($TEmedias as $TEmedia) : ?>
            <div class="accordion-group">
                
                <div class="accordion-heading">
                    <a class="accordion-toggle nomValue" pk="label<?php echo $TEmedia->id ;?>" data-toggle="collapse" data-parent="#TEmedia" href="#collapse<?php echo $TEmedia->id ;?>">
                        <?php echo $TEmedia->nom ;?>
                    </a>
                </div>
                <div id="collapse<?php echo $TEmedia->id ;?>" class="accordion-body collapse">
                    <div class="accordion-inner">
                        <h4>Liste des champs : <span class="edit CursorPointer" data-name="nom" data-type="text" data-pk="<?php echo $TEmedia->id ;?>" data-url="<?php echo $this->url("typeElement/editTypeElementAjax",array('id'=>$TEmedia->id)) ?>"><?php echo $TEmedia->nom ;?></span></h4>
                        <dl>
                            <dt class="muted">Titre [text]
                            </dt>
                            <dd></dd>
                            <dt class="muted">Description [textarea]
                            </dt>
                            <dd></dd>
                        <?php foreach ($TEmedia->__get('champs') as $champ) : ?>
                        
                            
                                <dt><span class="edit CursorPointer" data-name="label" data-type="text" data-pk="1" data-url="<?php echo $this->url("typeElement/editTypeElementAjax",array('id'=>$TEmedia->id,'idChamp'=>$champ->id)) ?>"><?php echo $champ->label;?></span> [<?php echo $champ->format;?>]

                                    </dt>
                                <dd><p class="edit CursorPointer" data-name="description" data-inputclass="" data-type="textarea" data-rows="2" data-pk="1" data-url="<?php echo $this->url("typeElement/editTypeElementAjax",array('id'=>$TEmedia->id,'idChamp'=>$champ->id)) ?>"><?php echo $champ->description;?></p></dd>
                                
                        <?php endforeach ;?>
                        </dl>
                        <a class="btn btn-primary" href="<?php echo $this->url("typeElement/editTypeElementAjax") ?>"><i class="icon-white icon-plus"></i> Nouveau Champ</a>
                    </div>
                </div>
            </div>
            <?php endforeach ;?>
        </div>
    </div>
</div>

<script type="text/javascript">

    $('.edit').on('save', function(e, params) {
        console.info($(this).attr('data-pk'));
        $('[pk="'+$(this).attr('data-name')+$(this).attr('data-pk')+'"]').html(params.newValue);
    });

    $('.edit').editable({
            mode: 'inline',
    });
</script>

<?php $this->headScript()->appendFile($this->basePath() . '/js/bootstrap-editable.js') ;?>




















